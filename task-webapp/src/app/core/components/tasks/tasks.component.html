<div class="task-component">
  <div class="row">
    <div class="col-sm-12">
      <section class="new-task">
        <h1>New Task</h1>
        <form #taskForm="ngForm" (submit)="createTask(taskForm)" ngForm>
          <mat-form-field class="full-width">
            <input matInput type="text" name="task" #task="ngModel" ngModel required>
            <mat-placeholder class="placeholder">Task</mat-placeholder>
            <mat-error *ngIf="task.invalid">Insert your task</mat-error>
          </mat-form-field>
          <mat-form-field class="full-width">
            <input matInput type="text" name="description" #description="ngModel" ngModel required>
            <mat-placeholder class="placeholder">Description</mat-placeholder>
            <mat-error *ngIf="description.invalid">Insert your description</mat-error>
          </mat-form-field>
          <button mat-raised-button color="primary" type="submit">Add task</button>
        </form>
      </section>
    </div>
  </div>
  <mat-divider></mat-divider>
  <div class="row">
    <div class="col-sm-12">
      <section class="list-of-tasks">
        <h1>Task list</h1>
        <div *ngFor="let item of allTasks; let i = index">
          <section *ngIf="!editoption[i]">
            <p>Task: {{item?.task}}</p>
            <p>Description: {{item?.description}}</p>
            <p>Status: {{item?.status}}</p>
          </section>
          <section class="edit-section" *ngIf="editoption[i]">
            <form #taskForm="ngForm" (submit)="updateTask(taskForm, item);editoption[i] =!editoption[i]" ngForm>
              <mat-form-field class="full-width">
                <input matInput type="text" name="task" #task="ngModel" ngModel value="{{item?.task}}" required>
                <mat-placeholder class="placeholder" *ngIf="item?.task.length <= 0">Task</mat-placeholder>
                <mat-placeholder class="placeholder" *ngIf="item?.task.length > 0">{{item?.task}}</mat-placeholder>
                <mat-error *ngIf="task.invalid">Insert your task</mat-error>
              </mat-form-field>
              <mat-form-field class="full-width">
                <input matInput type="text" name="description" #description="ngModel" ngModel
                  value="{{item?.description}}" required>
                <mat-placeholder class="placeholder" *ngIf="item?.description.length <= 0">Description</mat-placeholder>
                <mat-placeholder class="placeholder" *ngIf="item?.description.length > 0">{{item?.description}}
                </mat-placeholder>
                <mat-error *ngIf="description.invalid">Insert your description</mat-error>
              </mat-form-field>
              <mat-form-field class="full-width">
                  <input matInput type="text" name="status" #status="ngModel" ngModel
                    value="{{item?.status}}" required>
                  <mat-placeholder class="placeholder" *ngIf="item?.status.length <= 0">Status</mat-placeholder>
                  <mat-placeholder class="placeholder" *ngIf="item?.status.length > 0">{{item?.status}}
                  </mat-placeholder>
                  <mat-error *ngIf="description.invalid">Insert your description</mat-error>
                </mat-form-field>
              <button mat-raised-button color="primary" type="submit" style="margin-right: 1%">Update task</button>
              <button mat-raised-button color="warn" type="button" (click)="editoption[i] = !editoption[i]" *ngIf="editoption[i]" >Cancel edit</button>
            </form>
          </section>
          <button mat-raised-button color="primary" type="button" (click)="editoption[i] =!editoption[i]"
            *ngIf="!editoption[i]" style="margin-right: 1%">Edit</button>
          <button mat-raised-button color="warn" type="button" (click)="deleteTask(item?.id)"
            *ngIf="!editoption[i]">Delete</button>
          <mat-divider></mat-divider>
        </div>
      </section>
    </div>
  </div>
</div>
